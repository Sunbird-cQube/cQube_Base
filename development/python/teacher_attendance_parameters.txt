{
"tch_att_queries_filename":"""teacher_attendance_queries.json""",
"teacher_attendance_select_columns":"""select TCHCD as "teacher_id",SCHCD as "school_id",AC_YEAR as "year","Month",
case when "1"  = 'NULL' then '0' else "1" end  as "day_1",
case when "2"  = 'NULL' then '0' else "2" end  as "day_2",
case when "3"  = 'NULL' then '0' else "3" end  as "day_3",
case when "4"  = 'NULL' then '0' else "4" end  as "day_4",
case when "5"  = 'NULL' then '0' else "5" end  as "day_5",
case when "6"  = 'NULL' then '0' else "6" end  as "day_6",
case when "7"  = 'NULL' then '0' else "7" end  as "day_7",
case when "8"  = 'NULL' then '0' else "8" end  as "day_8",
case when "9"  = 'NULL' then '0' else "9" end  as "day_9",
case when "10"  = 'NULL' then '0' else "10" end  as "day_10",
case when "11"  = 'NULL' then '0' else "11" end  as "day_11",
case when "12"  = 'NULL' then '0' else "12" end  as "day_12",
case when "13"  = 'NULL' then '0' else "13" end  as "day_13",
case when "14"  = 'NULL' then '0' else "14" end  as "day_14",
case when "15"  = 'NULL' then '0' else "15" end  as "day_15",
case when "16"  = 'NULL' then '0' else "16" end  as "day_16",
case when "17"  = 'NULL' then '0' else "17" end  as "day_17",
case when "18"  = 'NULL' then '0' else "18" end  as "day_18",
case when "19"  = 'NULL' then '0' else "19" end  as "day_19",
case when "20"  = 'NULL' then '0' else "20" end  as "day_20",
case when "21"  = 'NULL' then '0' else "21" end  as "day_21",
case when "22"  = 'NULL' then '0' else "22" end  as "day_22",
case when "23"  = 'NULL' then '0' else "23" end  as "day_23",
case when "24"  = 'NULL' then '0' else "24" end  as "day_24",
case when "25"  = 'NULL' then '0' else "25" end  as "day_25",
case when "26"  = 'NULL' then '0' else "26" end  as "day_26",
case when "27"  = 'NULL' then '0' else "27" end  as "day_27",
case when "28"  = 'NULL' then '0' else "28" end  as "day_28",
case when "29"  = 'NULL' then '0' else "29" end  as "day_29",
case when "30"  = 'NULL' then '0' else "30" end  as "day_30",
case when "31"  = 'NULL' then '0' else "31" end  as "day_31"
from flowfile""",
"teacher_attendance_datatype_validation":"""Optional(parseLong()),Optional(parseLong()),Optional(StrNotNullOrEmpty()),Optional(parseLong()),
Optional(parseInt()),Optional(parseInt()),Optional(parseInt()),Optional(parseInt()),Optional(parseInt()),
Optional(parseInt()),Optional(parseInt()),Optional(parseInt()),Optional(parseInt()),Optional(parseInt()),
Optional(parseInt()),Optional(parseInt()),Optional(parseInt()),Optional(parseInt()),Optional(parseInt()),Optional(parseInt()),
Optional(parseInt()),Optional(parseInt()),Optional(parseInt()),Optional(parseInt()),Optional(parseInt()),Optional(parseInt()),
Optional(parseInt()),Optional(parseInt()),Optional(parseInt()),Optional(parseInt()),Optional(parseInt()),Optional(parseInt()),
Optional(parseInt()),Optional(parseInt()),Optional(parseInt())""",
"teacher_attendance_check_same_record":"""SELECT teacher_id,school_id,year,
month,day_1,day_2,day_3,day_4,day_5,day_6,day_7,day_8,day_9,day_10,day_11,day_12,day_13,day_14,day_15,day_16,day_17,day_18,day_19,day_20,day_21,day_22,day_23,day_24,day_25,day_26,day_27,day_28,day_29,day_30,day_31
,ff_uuid,count(*)-1  num_of_times
FROM teacher_attendance_staging_1
GROUP BY teacher_id,school_id,year,
month,day_1,day_2,day_3,day_4,day_5,day_6,day_7,day_8,day_9,day_10,day_11,day_12,day_13,day_14,day_15,day_16,day_17,day_18,day_19,day_20,day_21,day_22,day_23,day_24,day_25,day_26,day_27,day_28,day_29,day_30,day_31,ff_uuid
HAVING  COUNT(*) > 1""",
"teacher_attendance_filter_same_record":"""insert into teacher_attendance_staging_2(teacher_id,school_id,year,
month,day_1,day_2,day_3,day_4,day_5,day_6,day_7,day_8,day_9,day_10,day_11,day_12,day_13,day_14,day_15,day_16,day_17,day_18,day_19,day_20,day_21,day_22,day_23,
day_24,day_25,day_26,day_27,day_28,day_29,day_30,day_31,ff_uuid)
select teacher_id,school_id,year,
month,day_1,day_2,day_3,day_4,day_5,day_6,day_7,day_8,day_9,day_10,day_11,day_12,day_13,day_14,day_15,day_16,day_17,day_18,day_19,day_20,day_21,day_22,day_23,
day_24,day_25,day_26,day_27,day_28,day_29,day_30,day_31,ff_uuid
from (SELECT teacher_id,school_id,year,
month,day_1,day_2,day_3,day_4,day_5,day_6,day_7,day_8,day_9,day_10,day_11,day_12,day_13,day_14,day_15,day_16,day_17,day_18,day_19,day_20,day_21,day_22,day_23,
day_24,day_25,day_26,day_27,day_28,day_29,day_30,day_31,ff_uuid,
row_number() over (partition by teacher_id,school_id,year,
month,day_1,day_2,day_3,day_4,day_5,day_6,day_7,day_8,day_9,day_10,day_11,day_12,day_13,day_14,day_15,day_16,
day_17,day_18,day_19,day_20,day_21,day_22,day_23,day_24,day_25,day_26,day_27,day_28,day_29,day_30,day_31,ff_uuid) 
as rn from teacher_attendance_staging_1) sq Where rn =1""",
"teacher_attendance_check_null":"""select * from teacher_attendance_staging_1
where teacher_id is null or
school_id is null or
year is null or
month is null""",
"teacher_attendance_count_null":"""(select 
SUM(CASE when teacher_id IS NULL THEN 1 ELSE 0 END) AS count_null_teacherid,
SUM(CASE when school_id IS NULL THEN 1 ELSE 0 END) AS count_null_schoolid,
SUM(CASE when year IS NULL THEN 1 ELSE 0 END) AS count_null_AcademicYear,
SUM(CASE when month IS NULL THEN 1 ELSE 0 END) AS count_null_Month
from teacher_attendance_staging_1)""",
"teacher_attendance_null_table_name":"""tch_att_null_col""",
}
