[
{
"diksha_stack_bar_all_last_day": "select 'All' as district_id,'' as district_name,user_login_type,content_gradelevel,content_subject,sum(Total_content_plays) as Total_content_plays from ((select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5) union (select district_id,district_name,'All' as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,content_gradelevel,content_subject order by 1,3,4,5))as a group by user_login_type,content_gradelevel,content_subject"
},
{
"diksha_stack_bar_all_last_7_days": "select 'All' as district_id,'' as district_name,user_login_type,content_gradelevel,content_subject,sum(Total_content_plays) as Total_content_plays from ((select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5)union (select district_id,district_name,'All' as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,content_gradelevel,content_subject order by 1,3,4,5))as a group by user_login_type,content_gradelevel,content_subject"
},
{
"diksha_stack_bar_all_last_30_days": "select 'All' as district_id,'' as district_name,user_login_type,content_gradelevel,content_subject,sum(Total_content_plays) as Total_content_plays from ((select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5) union (select district_id,district_name,'All' as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,content_gradelevel,content_subject order by 1,3,4,5))as a group by user_login_type,content_gradelevel,content_subject"
},
{
"diksha_stack_bar_all_all": "select 'All' as district_id,'' as district_name,user_login_type,content_gradelevel,content_subject,sum(Total_content_plays) as Total_content_plays from ((select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5) union (select district_id,district_name,'All' as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name,content_gradelevel,content_subject order by 1,3,4,5))as a group by user_login_type,content_gradelevel,content_subject"
},
{
"diksha_stack_bar_last_day": "(select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select max(content_view_date) from diksha_total_content) group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5) union (select district_id,district_name,'All' as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,content_gradelevel,content_subject order by 1,3,4,5)"
},
{
"diksha_stack_bar_last_7_days":"(select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5) union (select district_id,district_name,'All' as user_login_type, initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,content_gradelevel,content_subject order by 1,3,4,5)"
},
{
"diksha_stack_bar_last_30_days":"(select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5) union (select district_id,district_name,'All' as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content) group by district_id,district_name,content_gradelevel,content_subject order by 1,3,4,5)"
},
{
"diksha_stack_bar_all":"(select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5) union (select district_id,district_name,'All' as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook'and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name,content_gradelevel,content_subject order by 1,3,4,5)"
},
{
"diksha_stack_bar_meta":"select json_build_object('timeRange',timeRange,'districtDetails',array_to_json(array_agg(row_to_json(b)))) from (select case when (select exists(select 1 from diksha_total_content where content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content)))=True then array['last_day','last_7_days','last_30_days'] when (select exists(select 1 from diksha_total_content where content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content)))=True then array['last_day','last_7_days'] when (select exists(select 1 from diksha_total_content where content_view_date = (select max(content_view_date) from diksha_total_content)))=True then array['last_day'] end as timeRange,cast(district_id as text) as district_id,district_name from diksha_total_content where district_name is not null and district_id is not null group by district_id,district_name,timeRange )as a join (select cast(district_id as text) as district_id,district_name from diksha_total_content where district_name is not null and district_id is not null group by district_id,district_name ) as b on a.district_id=b.district_id group by timeRange"	
},
{
"diksha_table_txtb_last_day":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject, content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date = (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays ,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date = (select max(content_view_date) from diksha_total_content ) group by content_name,collection_name,content_subject,content_gradelevel,content_medium,object_id)"
},
{
"diksha_table_txtb_last_7_days":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject, content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content ) and (select max(content_view_date) from diksha_total_content) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content ) and (select max(content_view_date) from diksha_total_content) group by content_name,collection_name,content_subject,content_gradelevel,content_medium,object_id)"
},
{
"diksha_table_txtb_last_30_days":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject, content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays ,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and  (select max(content_view_date) from diksha_total_content) group by content_name,collection_name,content_subject,content_gradelevel,content_medium,object_id)"
},
{
"diksha_table_txtb_all":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject, content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject, content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' group by content_name,collection_name,content_subject,content_gradelevel,content_medium,object_id)"
},
{
"diksha_table_txtb_meta":"select json_build_object('timeRange',timeRange,'districtDetails',array_to_json(array_agg(row_to_json(b)))) from (select case when (select exists(select 1 from diksha_total_content where content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content)))=True then array['last_day','last_7_days','last_30_days'] when (select exists(select 1 from diksha_total_content where content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content)))=True then array['last_day','last_7_days'] when (select exists(select 1 from diksha_total_content where content_view_date = (select max(content_view_date) from diksha_total_content)))=True then array['last_day'] end as timeRange,cast(district_id as text) as district_id,district_name from diksha_total_content where district_name is not null and district_id is not null group by district_id,district_name,timeRange )as a join (select cast(district_id as text) as district_id,district_name from diksha_total_content where district_name is not null and district_id is not null group by district_id,district_name ) as b on a.district_id=b.district_id group by timeRange"	
},
{
"diksha_table_crs_last_day":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject, content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date = (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date = (select max(content_view_date) from diksha_total_content ) group by content_name,collection_name,content_subject,content_gradelevel,content_medium,object_id)"
},
{
"diksha_table_crs_last_7_days":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays ,object_id as content_id,content_subject as Subject, content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content ) and  (select max(content_view_date) from diksha_total_content) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays  ,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content ) and (select max(content_view_date) from diksha_total_content) group by content_name,collection_name,content_subject,content_gradelevel,content_medium,object_id)"
},
{
"diksha_table_crs_last_30_days":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays ,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays  ,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content) group by content_name,collection_name,content_subject,content_gradelevel,content_medium,object_id)"
},
{
"diksha_table_crs_all":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays ,object_id as content_id,content_subject as Subject, content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays ,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' group by content_name,collection_name,content_subject,content_gradelevel,content_medium,object_id)"
},
{
"diksha_table_all_last_day":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where content_view_date = (select max(content_view_date) from diksha_total_content) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,collection_type,object_id,content_medium) union (select 'All' as  district_id,'' as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where content_view_date = (select max(content_view_date) from diksha_total_content) group by content_name,collection_name,content_subject,content_gradelevel,content_medium,collection_type,object_id)"
},
{
"diksha_table_all_last_7_days":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content) group by district_id,district_name,content_name,collection_name,content_subject,collection_type,content_gradelevel,object_id,content_medium) union (select 'All' as  district_id,'' as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content) group by content_name,collection_name,content_subject,content_gradelevel,collection_type,content_medium,object_id)"
},
{
"diksha_table_all_last_30_days":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium   from diksha_total_content  where content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content) group by district_id,district_name,content_name,collection_name,collection_type,content_subject,content_gradelevel,object_id,content_medium) union (select 'All' as  district_id,'' as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays, object_id as content_id,content_subject as Subject, content_gradelevel as Grade,content_medium as Medium from diksha_total_content where content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content) group by content_name,collection_name,content_subject,collection_type,content_gradelevel,content_medium,object_id)"
},
{
"diksha_table_all_all":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium    from diksha_total_content group by district_id,district_name,content_name,collection_type,collection_name,content_subject,content_gradelevel,content_medium,object_id) union (select 'All' as  district_id,'' as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays, object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content group by content_name,collection_name,collection_type,content_subject,content_gradelevel,content_medium,object_id)"
},
{
"diksha_barc_txtb_last_day":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select max(content_view_date) from diksha_total_content) group by district_id,district_name,collection_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays  from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select max(content_view_date) from diksha_total_content) group by district_id,district_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from  (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select max(content_view_date) from diksha_total_content) group by collection_name)as a"
},
{
"diksha_barc_txtb_last_7_days":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,collection_name, collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by collection_name)as a"
},
{
"diksha_barc_txtb_last_30_days":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,collection_name, collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from  (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by collection_name)as a"	
},
{
"diksha_barc_txtb_all":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays  from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name,collection_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null group by collection_name)as a"	
},
{
"diksha_barc_crs_last_day":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select max(content_view_date) from diksha_total_content) group by district_id,district_name,collection_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from  (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays  from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select max(content_view_date) from diksha_total_content) group by district_id,district_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select max(content_view_date) from diksha_total_content) group by collection_name)as a"	
},
{
"diksha_barc_crs_last_7_days":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select  district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays  from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,collection_name, collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,collection_type  order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course'and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by collection_name)as a"	
},
{
"diksha_barc_crs_last_30_days":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select  district_id,district_name,'all_collections' as type,collection_name, sum(total_count) as Total_content_plays  from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and  (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,collection_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from  (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by collection_name)as a"	
},
{
"diksha_barc_crs_all":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name, sum(total_count) as Total_content_plays  from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name,collection_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null group by collection_name)as a"
},
{
"diksha_barc_all_last_day":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select  district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays  from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select max(content_view_date) from diksha_total_content) group by district_id,district_name,collection_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select max(content_view_date) from diksha_total_content) group by district_id,district_name  order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select max(content_view_date) from diksha_total_content) group by collection_name)as a"
},
{
"diksha_barc_all_last_7_days":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,collection_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by district_id,district_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from  (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by collection_name)as a"
},
{
"diksha_barc_all_last_30_days":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,collection_name,'all_collections' as type,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by district_id,district_name,collection_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'All' as collection_name,'all_districts' as type,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and  (select max(content_view_date) from diksha_total_content ) group by district_id,district_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,collection_name,'collection_footer' as type,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content ) group by collection_name)as a"
},
{
"diksha_barc_all_all":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,collection_name,'all_collections' as type,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name,collection_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from  (select district_id,district_name,'All' as collection_name,'all_districts' as type,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,collection_name,'collection_footer' as type,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null  and user_login_type <> 'NA'and district_name is not null and district_id is not null group by collection_name)as a"
},
{"diksha_tpd_district_wise":"select district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,round(cast(avg(percentage_teachers)as numeric),1) as percentage_teachers,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select max(enrolled_date) from diksha_tpd_agg) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,round(cast(avg(percentage_teachers)as numeric),1) as percentage_teachers,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select max(enrolled_date)-INTERVAL '7 DAY' from diksha_tpd_agg) and (select max(enrolled_date) from diksha_tpd_agg ) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,round(cast(avg(percentage_teachers)as numeric),1) as percentage_teachers,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select max(enrolled_date)-INTERVAL '30 DAY' from diksha_tpd_agg) and (select max(enrolled_date) from diksha_tpd_agg ) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,round(cast(avg(percentage_teachers)as numeric),1) as percentage_teachers,'All' as time_range from diksha_tpd_agg group by district_id,district_name,collection_id,collection_name"
},
{"diksha_tpd_block_wise":"select block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,round(cast(avg(percentage_teachers)as numeric),1) as percentage_teachers,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select max(enrolled_date) from diksha_tpd_agg) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,round(cast(avg(percentage_teachers)as numeric),1) as percentage_teachers,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select max(enrolled_date)-INTERVAL '7 DAY' from diksha_tpd_agg) and (select max(enrolled_date) from diksha_tpd_agg ) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,round(cast(avg(percentage_teachers)as numeric),1) as percentage_teachers,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select max(enrolled_date)-INTERVAL '30 DAY' from diksha_tpd_agg) and (select max(enrolled_date) from diksha_tpd_agg ) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,round(cast(avg(percentage_teachers)as numeric),1) as percentage_teachers,'All' as time_range from diksha_tpd_agg group by block_id,block_name,district_id,district_name,collection_id,collection_name"
},
{
"diksha_tpd_cluster_wise":"select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,round(cast(avg(percentage_teachers)as numeric),1) as percentage_teachers,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select max(enrolled_date) from diksha_tpd_agg) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,round(cast(avg(percentage_teachers)as numeric),1) as percentage_teachers,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select max(enrolled_date)-INTERVAL '7 DAY' from diksha_tpd_agg) and (select max(enrolled_date) from diksha_tpd_agg ) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,round(cast(avg(percentage_teachers)as numeric),1) as percentage_teachers,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select max(enrolled_date)-INTERVAL '30 DAY' from diksha_tpd_agg) and (select max(enrolled_date) from diksha_tpd_agg ) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,round(cast(avg(percentage_teachers)as numeric),1) as percentage_teachers,'All' as time_range from diksha_tpd_agg group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name"
},
{"diksha_tpd_school_wise":"select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,round(cast(avg(percentage_teachers)as numeric),1) as percentage_teachers,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select max(enrolled_date) from diksha_tpd_agg) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,round(cast(avg(percentage_teachers)as numeric),1) as percentage_teachers,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select max(enrolled_date)-INTERVAL '7 DAY' from diksha_tpd_agg) and (select max(enrolled_date) from diksha_tpd_agg ) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,round(cast(avg(percentage_teachers)as numeric),1) as percentage_teachers,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select max(enrolled_date)-INTERVAL '30 DAY' from diksha_tpd_agg) and (select max(enrolled_date) from diksha_tpd_agg ) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,round(cast(avg(percentage_teachers)as numeric),1) as percentage_teachers,'All' as time_range from diksha_tpd_agg group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name"
}
]
