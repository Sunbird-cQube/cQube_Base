[
{
"stud_sem_meta":"select json_agg(meta) from (select (json_build_object('id',semester,'name',concat('Semester ',semester)))as meta from school_student_subject_total_marks group by semester)as a;"
},
{
"stud_sem_school_wise": "select a.x_axis,school_name,cluster_id,cluster_name,crc_name,block_id,block_name,x_value,district_id,district_name,y_axis,y_value,z_axis,z_value,students_count,total_schools,a.semester, b.grade_3,b.grade_4,b.grade_5,b.grade_6,b.grade_7,b.grade_8 from (SELECT school_id AS x_axis,Initcap(school_name) AS school_name,district_id,Initcap(district_name) AS district_name,block_id,Initcap(block_name)AS block_name,cluster_id,Initcap(cluster_name) AS cluster_name,Initcap(crc_name)AS crc_name,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,semester,'latitude' AS y_axis,school_latitude AS y_value,'longitude' AS z_axis,school_longitude AS z_value,Round(NULLIF(Sum(case when subject_1_marks_scored is null then 0 else subject_1_marks_scored end +case when subject_3_marks_scored is null then 0 else subject_3_marks_scored end+case when subject_2_marks_scored is null then 0 else subject_2_marks_scored end+case when subject_4_marks_scored is null then 0 else subject_4_marks_scored end+case when subject_5_marks_scored is null then 0 else subject_5_marks_scored end+case when subject_7_marks_scored is null then 0 else subject_7_marks_scored end+case when subject_6_marks_scored is null then 0 else subject_6_marks_scored end+case when subject_8_marks_scored is null then 0 else subject_8_marks_scored end),0)*100.0/NULLIF(Sum(subject_1_total_marks+subject_3_total_marks+subject_2_total_marks+subject_4_total_marks+subject_5_total_marks+subject_7_total_marks+subject_6_total_marks+subject_8_total_marks),0),1) AS x_value FROM school_student_subject_total_marks WHERE district_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 and cluster_name is not null AND school_latitude IS NOT NULL AND school_name IS NOT NULL GROUP BY school_id,school_name,crc_name,school_latitude,school_longitude,cluster_id,cluster_name,crc_name,block_id,block_name,district_id,district_name,semester having Sum(case when subject_1_marks_scored is null then 0 else subject_1_marks_scored end +case when subject_3_marks_scored is null then 0 else subject_3_marks_scored end+case when subject_2_marks_scored is null then 0 else subject_2_marks_scored end+case when subject_4_marks_scored is null then 0 else subject_4_marks_scored end+case when subject_5_marks_scored is null then 0 else subject_5_marks_scored end+case when subject_7_marks_scored is null then 0 else subject_7_marks_scored end+case when subject_6_marks_scored is null then 0 else subject_6_marks_scored end+case when subject_8_marks_scored is null then 0 else subject_8_marks_scored end) <> 0)as a left join (select cast(split_part(string,'_',1) as bigint)as x_axis,cast(split_part(string,'_',2) as bigint) as semester,* from crosstab ('select concat(x_axis,''_'',semester)as string,grade,x_value from school_grade order by 1,2') as ct (string text,\"grade_3\" numeric(5,2),\"grade_4\" numeric(5,2),\"grade_5\" numeric(5,2),\"grade_6\" numeric(5,2),\"grade_7\" numeric(5,2),\"grade_8\" numeric(5,2))) b on a.x_axis=b.x_axis and a.semester=b.semester;"
},
{
"stud_sem_district_wise": "select a.x_axis,district_name,x_value,y_axis,y_value,z_axis,z_value,students_count,total_schools,a.semester,b.grade_3,b.grade_4,b.grade_5,b.grade_6,b.grade_7,b.grade_8,c.value_below_33,c.value_between_33_60,c.value_between_60_75,c.value_above_75,c.percent_below_33,c.percent_between_33_60,c.percent_between_60_75,c.percent_above_75 from (SELECT district_id AS x_axis,Initcap(district_name) AS district_name,Round(Sum(case when subject_1_marks_scored is null then 0 else subject_1_marks_scored end +case when subject_3_marks_scored is null then 0 else subject_3_marks_scored end+case when subject_2_marks_scored is null then 0 else subject_2_marks_scored end+case when subject_4_marks_scored is null then 0 else subject_4_marks_scored end+case when subject_5_marks_scored is null then 0 else subject_5_marks_scored end+case when subject_7_marks_scored is null then 0 else subject_7_marks_scored end+case when subject_6_marks_scored is null then 0 else subject_6_marks_scored end+case when subject_8_marks_scored is null then 0 else subject_8_marks_scored end)*100.0/Sum(subject_1_total_marks+subject_3_total_marks+subject_2_total_marks+subject_4_total_marks+subject_5_total_marks+subject_7_total_marks+subject_6_total_marks+subject_8_total_marks),1)AS x_value,'latitude' AS y_axis,district_latitude AS y_value,'longitude' AS z_axis,district_longitude AS z_value,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,semester FROM school_student_subject_total_marks WHERE district_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 and cluster_name is not null AND school_latitude IS NOT NULL AND school_name IS NOT NULL GROUP BY district_id,district_latitude,district_longitude,district_name,semester having Sum(case when subject_1_marks_scored is null then 0 else subject_1_marks_scored end+case when subject_3_marks_scored is null then 0 else subject_3_marks_scored end+case when subject_2_marks_scored is null then 0 else subject_2_marks_scored end+case when subject_4_marks_scored is null then 0 else subject_4_marks_scored end+case when subject_5_marks_scored is null then 0 else subject_5_marks_scored end+case when subject_7_marks_scored is null then 0 else subject_7_marks_scored end+case when subject_6_marks_scored is null then 0 else subject_6_marks_scored end+case when subject_8_marks_scored is null then 0 else subject_8_marks_scored end) <> 0)as a left join(select cast(split_part(string,'_',1) as bigint)as x_axis,cast(split_part(string,'_',2) as bigint) as semester,* from crosstab('select concat(x_axis,''_'',semester)as string,grade,x_value from district_grade order by 1,2') as ct (string text,\"grade_3\" numeric(5,2),\"grade_4\" numeric(5,2),\"grade_5\" numeric(5,2),\"grade_6\" numeric(5,2),\"grade_7\" numeric(5,2),\"grade_8\" numeric(5,2))) b on a.x_axis=b.x_axis and a.semester=b.semester left join (select x_axis,semester,sum(case when x_value <=33 then 1 else 0 end)as value_below_33,sum(case when x_value > 33 and x_value<=60 then 1 else 0 end)as value_between_33_60,sum(case when x_value > 60 and x_value<=75 then 1 else 0 end)as value_between_60_75,sum(case when x_value >75 then 1 else 0 end)as value_above_75,round(sum(case when x_value <=33 then 1 else 0 end)*100.0/count(distinct(school_id)),2) as percent_below_33,round(sum(case when x_value > 33 and x_value<=60 then 1 else 0 end)*100.0/count(distinct(school_id)),2) as percent_between_33_60,round(sum(case when x_value > 60 and x_value<=75 then 1 else 0 end)*100.0/count(distinct(school_id)),2) as percent_between_60_75,round(sum(case when x_value >75 then 1 else 0 end)*100.0/count(distinct(school_id)),2) as percent_above_75 from district_school group by x_axis,semester) as c on b.x_axis=c.x_axis and b.semester=c.semester;"
},
{
"stud_sem_block_wise": "select a.x_axis,block_name,x_value,district_id,district_name,y_axis,y_value,z_axis,z_value,students_count,total_schools,a.semester,b.grade_3,b.grade_4,b.grade_5,b.grade_6,b.grade_7,b.grade_8,c.value_below_33,c.value_between_33_60,c.value_between_60_75,c.value_above_75,c.percent_below_33,c.percent_between_33_60,c.percent_between_60_75,c.percent_above_75 from (SELECT block_id AS x_axis,Initcap(block_name) AS block_name,district_id,Initcap(district_name) AS district_name,'latitude' AS y_axis,block_latitude AS y_value,'longitude' AS z_axis,block_longitude AS z_value,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,semester,Round(Sum(case when subject_1_marks_scored is null then 0 else subject_1_marks_scored end +case when subject_3_marks_scored is null then 0 else subject_3_marks_scored end+case when subject_2_marks_scored is null then 0 else subject_2_marks_scored end+case when subject_4_marks_scored is null then 0 else subject_4_marks_scored end+case when subject_5_marks_scored is null then 0 else subject_5_marks_scored end+case when subject_7_marks_scored is null then 0 else subject_7_marks_scored end+case when subject_6_marks_scored is null then 0 else subject_6_marks_scored end+case when subject_8_marks_scored is null then 0 else subject_8_marks_scored end)*100.0/Sum(subject_1_total_marks+subject_3_total_marks+subject_2_total_marks+subject_4_total_marks+subject_5_total_marks+subject_7_total_marks+subject_6_total_marks+subject_8_total_marks),1)AS x_value FROM school_student_subject_total_marks WHERE district_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 and cluster_name is not null AND school_latitude IS NOT NULL AND school_name IS NOT NULL GROUP BY block_id,block_name,block_latitude,block_longitude,district_id,district_name,semester having Sum(case when subject_1_marks_scored is null then 0 else subject_1_marks_scored end +case when subject_3_marks_scored is null then 0 else subject_3_marks_scored end+case when subject_2_marks_scored is null then 0 else subject_2_marks_scored end+case when subject_4_marks_scored is null then 0 else subject_4_marks_scored end+case when subject_5_marks_scored is null then 0 else subject_5_marks_scored end+case when subject_7_marks_scored is null then 0 else subject_7_marks_scored end+case when subject_6_marks_scored is null then 0 else subject_6_marks_scored end+case when subject_8_marks_scored is null then 0 else subject_8_marks_scored end) <> 0)as a left join (select cast(split_part(string,'_',1) as bigint)as x_axis,cast(split_part(string,'_',2) as bigint) as semester,* from crosstab('select concat(x_axis,''_'',semester)as string,grade,x_value from block_grade order by 1,2') as ct (string text,\"grade_3\" numeric(5,2),\"grade_4\" numeric(5,2),\"grade_5\" numeric(5,2),\"grade_6\" numeric(5,2),\"grade_7\" numeric(5,2),\"grade_8\" numeric(5,2))) b on a.x_axis=b.x_axis and a.semester=b.semester left join (select x_axis,semester,sum(case when x_value <=33 then 1 else 0 end)as value_below_33,sum(case when x_value > 33 and x_value<=60 then 1 else 0 end)as value_between_33_60,sum(case when x_value > 60 and x_value<=75 then 1 else 0 end)as value_between_60_75,sum(case when x_value >75 then 1 else 0 end)as value_above_75,round(sum(case when x_value <=33 then 1 else 0 end)*100.0/count(distinct(school_id)),2) as percent_below_33,round(sum(case when x_value > 33 and x_value<=60 then 1 else 0 end)*100.0/count(distinct(school_id)),2) as percent_between_33_60,round(sum(case when x_value > 60 and x_value<=75 then 1 else 0 end)*100.0/count(distinct(school_id)),2) as percent_between_60_75,round(sum(case when x_value >75 then 1 else 0 end)*100.0/count(distinct(school_id)),2) as percent_above_75 from block_school group by x_axis,semester) as c on b.x_axis=c.x_axis and b.semester=c.semester;"
},
{
"stud_sem_cluster_wise": "select a.x_axis,cluster_name,block_id,block_name,x_value,district_id,district_name,y_axis,y_value,z_axis,z_value,students_count,total_schools,a.semester,b.grade_3,b.grade_4,b.grade_5,b.grade_6,b.grade_7,b.grade_8,c.value_below_33,c.value_between_33_60,c.value_between_60_75,c.value_above_75,c.percent_below_33,c.percent_between_33_60,c.percent_between_60_75,c.percent_above_75 from (SELECT distinct cluster_id AS x_axis,INITCAP(cluster_name) AS cluster_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name) AS block_name,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,semester,'latitude' AS y_axis,cluster_latitude AS y_value,'longitude' AS z_axis,cluster_longitude AS z_value,Round(NULLIF(Sum(case when subject_1_marks_scored is null then 0 else subject_1_marks_scored end +case when subject_3_marks_scored is null then 0 else subject_3_marks_scored end+case when subject_2_marks_scored is null then 0 else subject_2_marks_scored end+case when subject_4_marks_scored is null then 0 else subject_4_marks_scored end+case when subject_5_marks_scored is null then 0 else subject_5_marks_scored end+case when subject_7_marks_scored is null then 0 else subject_7_marks_scored end+case when subject_6_marks_scored is null then 0 else subject_6_marks_scored end+case when subject_8_marks_scored is null then 0 else subject_8_marks_scored end),0)*100.0/NULLIF(Sum(subject_1_total_marks+subject_3_total_marks+subject_2_total_marks+subject_4_total_marks+subject_5_total_marks+subject_7_total_marks+subject_6_total_marks+subject_8_total_marks),0),1) AS x_value FROM school_student_subject_total_marks WHERE district_name IS NOT NULL AND block_latitude IS NOT NULL and cluster_name is not null AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL GROUP BY cluster_id,cluster_name,cluster_latitude,cluster_longitude,block_id,block_name,district_id,district_name,semester having Sum(case when subject_1_marks_scored is null then 0 else subject_1_marks_scored end +case when subject_3_marks_scored is null then 0 else subject_3_marks_scored end+case when subject_2_marks_scored is null then 0 else subject_2_marks_scored end+case when subject_4_marks_scored is null then 0 else subject_4_marks_scored end+case when subject_5_marks_scored is null then 0 else subject_5_marks_scored end+case when subject_7_marks_scored is null then 0 else subject_7_marks_scored end +case when subject_6_marks_scored is null then 0 else subject_6_marks_scored end+case when subject_8_marks_scored is null then 0 else subject_8_marks_scored end) <> 0)as a left join (select cast(split_part(string,'_',1) as bigint)as x_axis,cast(split_part(string,'_',2) as bigint) as semester,* from crosstab ('select concat(x_axis,''_'',semester)as string,grade,x_value from cluster_grade order by 1,2') as ct (string text,\"grade_3\" numeric(5,2),\"grade_4\" numeric(5,2),\"grade_5\" numeric(5,2),\"grade_6\" numeric(5,2),\"grade_7\" numeric(5,2),\"grade_8\" numeric(5,2))) b on a.x_axis=b.x_axis and a.semester=b.semester left join (select x_axis,semester,sum(case when x_value <=33 then 1 else 0 end)as value_below_33,sum(case when x_value > 33 and x_value<=60 then 1 else 0 end)as value_between_33_60,sum(case when x_value > 60 and x_value<=75 then 1 else 0 end)as value_between_60_75,sum(case when x_value >75 then 1 else 0 end)as value_above_75,round(sum(case when x_value <=33 then 1 else 0 end)*100.0/count(distinct(school_id)),2) as percent_below_33,round(sum(case when x_value > 33 and x_value<=60 then 1 else 0 end)*100.0/count(distinct(school_id)),2) as percent_between_33_60,round(sum(case when x_value > 60 and x_value<=75 then 1 else 0 end)*100.0/count(distinct(school_id)),2) as percent_between_60_75,round(sum(case when x_value >75 then 1 else 0 end)*100.0/count(distinct(school_id)),2) as percent_above_75 from cluster_school group by x_axis,semester)as c on b.x_axis=c.x_axis and b.semester=c.semester;"
},
{
"stud_sem_comp_district_wise": "select a.district_latitude,a.district_longitude,a.district_id,a.district_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,a.semester from (select district_id ,district_name,district_latitude,district_longitude,Count(DISTINCT(school_id)) AS total_schools_not_received,semester from semester_exception_completion_data group by district_id,district_name,district_latitude,district_longitude,semester)as a join (select district_id,count(distinct(school_id)) as total_schools from school_hierarchy_details group by district_id)as b on a.district_id=b.district_id"
},
{
"stud_sem_comp_block_wise":"select a.block_latitude,a.block_longitude,a.district_id,a.district_name,a.block_id,a.block_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,a.semester from (select district_id ,district_name,block_id,block_name,block_latitude,block_longitude,Count(DISTINCT(school_id)) AS total_schools_not_received,semester from semester_exception_completion_data group by district_id,district_name,block_id,block_name,block_latitude,block_longitude,semester)as a join (select block_id,count(distinct(school_id)) as total_schools from school_hierarchy_details group by block_id)as b on a.block_id=b.block_id"
},
{
"stud_sem_comp_cluster_wise":"select a.cluster_latitude,a.cluster_longitude,a.district_id,a.district_name,a.block_id,a.block_name,a.cluster_id,a.cluster_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,a.semester from (select district_id ,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude,semester,Count(DISTINCT(school_id)) AS total_schools_not_received from semester_exception_completion_data group by district_id,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude,semester)as a join (select cluster_id,count(distinct(school_id)) as total_schools from school_hierarchy_details group by cluster_id)as b on a.cluster_id=b.cluster_id"
},
{
"stud_sem_comp_school_wise":"select school_latitude,school_longitude,district_id,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,Count(DISTINCT(school_id)) AS Total_schools_with_missing_data,semester from semester_exception_completion_data group by district_id ,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,school_latitude,school_longitude,semester"
}
]
