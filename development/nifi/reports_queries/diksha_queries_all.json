[
{
"diksha_stack_bar_all_last_day": "select 'All' as district_id,'' as district_name,user_login_type,content_gradelevel,content_subject,sum(Total_content_plays) as Total_content_plays from ((select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select now()::DATE) group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5) union (select district_id,district_name,'All' as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select now()::DATE) group by district_id,district_name,content_gradelevel,content_subject order by 1,3,4,5))as a group by user_login_type,content_gradelevel,content_subject"
},
{
"diksha_stack_bar_all_last_7_days": "select 'All' as district_id,'' as district_name,user_login_type,content_gradelevel,content_subject,sum(Total_content_plays) as Total_content_plays from ((select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject, sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5) union (select  district_id,district_name,'All' as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_gradelevel,content_subject order by 1,3,4,5))as a group by user_login_type,content_gradelevel,content_subject"
},
{
"diksha_stack_bar_all_last_30_days": "select 'All' as district_id,'' as district_name,user_login_type,content_gradelevel,content_subject,sum(Total_content_plays) as Total_content_plays from ((select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5) union (select district_id,district_name,'All' as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_gradelevel,content_subject order by 1,3,4,5))as a group by user_login_type,content_gradelevel,content_subject"
},
{
"diksha_stack_bar_all_all": "select 'All' as district_id,'' as district_name,user_login_type,content_gradelevel,content_subject,sum(Total_content_plays) as Total_content_plays from ((select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5) union (select district_id,district_name,'All' as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name,content_gradelevel,content_subject order by 1,3,4,5))as a group by user_login_type,content_gradelevel,content_subject"
},
{
"diksha_stack_bar_last_day": "(select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select now()::DATE) group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5) union (select district_id,district_name,'All' as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select now()::DATE) group by district_id,district_name, content_gradelevel,content_subject order by 1,3,4,5)"
},
{
"diksha_stack_bar_last_7_days":"(select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5) union (select district_id,district_name,'All' as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_gradelevel,content_subject order by 1,3,4,5)"
},
{
"diksha_stack_bar_last_30_days":"(select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5) union (select district_id,district_name,'All' as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_gradelevel,content_subject order by 1,3,4,5)"
},
{
"diksha_stack_bar_all":"(select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5) union (select district_id,district_name,'All' as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name,content_gradelevel,content_subject order by 1,3,4,5)"
},
{
"diksha_stack_bar_meta":"select json_build_object('timeRange',timeRange,'districtDetails',array_to_json(array_agg(row_to_json(b)))) from (select case when (select exists(select 1 from diksha_total_content where content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content)))=True then array['last_day','last_7_days','last_30_days'] when (select exists(select 1 from diksha_total_content where content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content)))=True then array['last_day','last_7_days'] when (select exists(select 1 from diksha_total_content where content_view_date = (select max(content_view_date) from diksha_total_content)))=True then array['last_day'] end as timeRange,cast(district_id as text) as district_id,district_name from diksha_total_content where district_name is not null and district_id is not null group by district_id,district_name,timeRange )as a join (select cast(district_id as text) as district_id,district_name from diksha_total_content where district_name is not null and district_id is not null group by district_id,district_name ) as b on a.district_id=b.district_id group by timeRange"	
},
{
"diksha_table_txtb_last_day":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date = (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays ,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date = (select now()::DATE) group by content_name,collection_name,content_subject,content_gradelevel,content_medium,object_id)"
},
{
"diksha_table_txtb_last_7_days":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by content_name,collection_name,content_subject,content_gradelevel,content_medium,object_id)"
},
{
"diksha_table_txtb_last_30_days":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and  (select now()::DATE) group by content_name,collection_name,content_subject,content_gradelevel,content_medium,object_id)"
},
{
"diksha_table_txtb_all":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' group by content_name,collection_name,content_subject,content_gradelevel,content_medium,object_id)"
},
{
"diksha_table_txtb_meta":"select json_build_object('timeRange',timeRange,'districtDetails',array_to_json(array_agg(row_to_json(b)))) from (select case when (select exists(select 1 from diksha_total_content where content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content)))=True then array['last_day','last_7_days','last_30_days'] when (select exists(select 1 from diksha_total_content where content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content)))=True then array['last_day','last_7_days'] when (select exists(select 1 from diksha_total_content where content_view_date = (select max(content_view_date) from diksha_total_content)))=True then array['last_day'] end as timeRange,cast(district_id as text) as district_id,district_name from diksha_total_content where district_name is not null and district_id is not null group by district_id,district_name,timeRange )as a join (select cast(district_id as text) as district_id,district_name from diksha_total_content where district_name is not null and district_id is not null group by district_id,district_name ) as b on a.district_id=b.district_id group by timeRange"	
},
{
"diksha_table_crs_last_day":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date = (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date = (select now()::DATE) group by content_name,collection_name,content_subject,content_gradelevel,content_medium,object_id)"
},
{
"diksha_table_crs_last_7_days":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays ,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by content_name,collection_name,content_subject,content_gradelevel,content_medium,object_id)"
},
{
"diksha_table_crs_last_30_days":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays ,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays ,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by content_name,collection_name,content_subject,content_gradelevel,content_medium,object_id)"
},
{
"diksha_table_crs_all":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays ,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' group by content_name,collection_name,content_subject,content_gradelevel,content_medium,object_id)"
},
{
"diksha_table_all_last_day":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where content_view_date = (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,collection_type,object_id,content_medium) union (select 'All' as  district_id,'' as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where content_view_date = (select now()::DATE) group by content_name,collection_name,content_subject,content_gradelevel,content_medium,collection_type,object_id)"
},
{
"diksha_table_all_last_7_days":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,collection_type,content_gradelevel,object_id,content_medium) union (select 'All' as  district_id,'' as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by content_name,collection_name,content_subject,content_gradelevel,collection_type,content_medium,object_id)"
},
{
"diksha_table_all_last_30_days":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,collection_type,content_subject,content_gradelevel,object_id,content_medium) union (select 'All' as  district_id,'' as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by content_name,collection_name,content_subject,collection_type,content_gradelevel,content_medium,object_id)"
},
{
"diksha_table_all_all":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content group by district_id,district_name,content_name,collection_type,collection_name,content_subject,content_gradelevel,content_medium,object_id) union (select 'All' as  district_id,'' as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content group by content_name,collection_name,collection_type,content_subject,content_gradelevel,content_medium,object_id)"
},
{
"diksha_barc_txtb_last_day":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select now()::DATE) group by district_id,district_name,collection_name, collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select now()::DATE) group by district_id,district_name,collection_type  order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select now()::DATE) group by collection_name)as a"
},
{
"diksha_barc_txtb_last_7_days":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by collection_name)as a"
},
{
"diksha_barc_txtb_last_30_days":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by collection_name)as a"	
},
{
"diksha_barc_txtb_all":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name,collection_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='textbook' and user_login_type <> 'NA'and district_name is not null and district_id is not null group by collection_name)as a"	
},
{
"diksha_barc_crs_last_day":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select now()::DATE)group by district_id,district_name,collection_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select now()::DATE) group by district_id,district_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select now()::DATE) group by collection_name)as a"	
},
{
"diksha_barc_crs_last_7_days":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by collection_name)as a"	
},
{
"diksha_barc_crs_last_30_days":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by collection_name)as a"	
},
{
"diksha_barc_crs_all":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course'and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name,collection_name, collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and lower(collection_type) ='course' and user_login_type <> 'NA'and district_name is not null and district_id is not null group by collection_name)as a"
},
{
"diksha_barc_all_last_day":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select now()::DATE) group by district_id,district_name,collection_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null  and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select now()::DATE) group by district_id,district_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select now()::DATE) group by collection_name)as a"
},
{
"diksha_barc_all_last_7_days":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by collection_name)as a"
},
{
"diksha_barc_all_last_30_days":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,collection_name,'all_collections' as type,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'All' as collection_name,'all_districts' as type,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from  (select 1 as district_id,'' as district_name,collection_name,'collection_footer' as type,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by collection_name)as a"
},
{
"diksha_barc_all_all":"select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select  district_id,district_name,collection_name,'all_collections' as type,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name,collection_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'All' as collection_name,'all_districts' as type,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,collection_name,'collection_footer' as type,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and user_login_type <> 'NA'and district_name is not null and district_id is not null group by collection_name) as a"
},
{"diksha_tpd_district_wise":"select a.*,round(coalesce(sum(sde.total_enrolled),0)*100/nullif(sum(sde.total_teachers),0),2) as percentage_teachers from (select district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select (now()::Date)) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select (now()::Date)) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'All' as time_range from diksha_tpd_agg group by district_id,district_name,collection_id,collection_name)as a left join school_diksha_enrolled as sde on a.district_id=sde.district_id and a.collection_id=sde.collection_id and a.time_range=sde.time_range group by a.district_id,a.district_name,a.collection_id,a.collection_name,a.collection_progress,a.time_range"
},
{"diksha_tpd_block_wise":"select a.*,round(coalesce(sum(sde.total_enrolled),0)*100/nullif(sum(sde.total_teachers),0),2) as percentage_teachers from (select block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select (now()::Date)) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select (now()::Date)) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'All' as time_range from diksha_tpd_agg group by block_id,block_name,district_id,district_name,collection_id,collection_name)as a left join school_diksha_enrolled as sde on a.block_id=sde.block_id and a.collection_id=sde.collection_id and a.time_range=sde.time_range group by a.district_id,a.district_name,a.block_id,a.block_name,a.collection_id,a.collection_name,a.collection_progress,a.time_range"
},
{
"diksha_tpd_cluster_wise":"select a.*,round(coalesce(sum(sde.total_enrolled),0)*100/nullif(sum(sde.total_teachers),0),2) as percentage_teachers from (select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select (now()::Date)) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select (now()::Date)) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'All' as time_range from diksha_tpd_agg group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name)as a left join school_diksha_enrolled as sde on a.cluster_id=sde.cluster_id and a.collection_id=sde.collection_id and a.time_range=sde.time_range group by a.district_id,a.district_name,a.block_id,a.block_name,a.cluster_id,a.cluster_name,a.collection_id,a.collection_name,a.collection_progress,a.time_range"
},
{"diksha_tpd_school_wise":"select a.*,round(coalesce(sum(sde.total_enrolled),0)*100/Nullif(sum(sde.total_teachers),0),2) as percentage_teachers from (select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select (now()::Date)) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select (now()::Date)) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'All' as time_range from diksha_tpd_agg group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name)as a left join school_diksha_enrolled as sde on a.school_id=sde.school_id and a.collection_id=sde.collection_id and a.time_range=sde.time_range group by a.district_id,a.district_name,a.block_id,a.block_name,a.cluster_id,a.cluster_name,a.school_id,a.school_name,a.collection_id,a.collection_name,a.collection_progress,a.time_range"
},
{
"diksha_tpd_r2_district_last_day":"select district_id,district_name,collection_id,collection_name,'collections' as type,'district'as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion, 'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'district'as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by district_id,district_name"
},
{ 
"diksha_tpd_r2_district_last_7_days":"select district_id,district_name,collection_id,collection_name,'collections' as type,'district' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'district'as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name"
},
{
"diksha_tpd_r2_district_last_30_days":"select district_id,district_name,collection_id,collection_name,'collections' as type,'district' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'district' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name"	
},
{
"diksha_tpd_r2_district_overall":"select district_id,district_name,collection_id,collection_name,'collections' as type,'district' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'All' as time_range from diksha_tpd_agg group by district_id,district_name,collection_id,collection_name union select district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'district' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'All' as time_range from diksha_tpd_agg group by district_id,district_name"	
},
{
"diksha_tpd_r2_block_last_day":"select block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'block'as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by block_id,block_name,district_id,district_name"	
},
{
"diksha_tpd_r2_block_last_7_days":"select block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by block_id,block_name,district_id,district_name"	
},
{
"diksha_tpd_r2_block_last_30_days":"select block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by block_id,block_name,district_id,district_name"	
},
{
"diksha_tpd_r2_block_overall":"select block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'All' as time_range from diksha_tpd_agg group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'All' as time_range from diksha_tpd_agg  group by block_id,block_name,district_id,district_name"	
},
{
"diksha_tpd_r2_cluster_last_day":"select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name"	
},
{
"diksha_tpd_r2_cluster_last_7_days":"select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'Cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name"	
},
	{
"diksha_tpd_r2_cluster_last_30_days":"select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name"	
},
	{
"diksha_tpd_r2_cluster_overall":"select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'All' as time_range from diksha_tpd_agg group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'All' as time_range from diksha_tpd_agg group by cluster_id,cluster_name,block_id,block_name,district_id,district_name"	
},
{
"diksha_tpd_r2_school_last_day":"select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school 'as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name"	
},
{
"diksha_tpd_r2_school_last_7_days":"select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name"	
},
	{
 "diksha_tpd_r2_school_last_30_days":"select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name"	
},
	{
"diksha_tpd_r2_school_overall":"select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'All' as time_range from diksha_tpd_agg group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'All' as time_range from diksha_tpd_agg  group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name"	
},
{
"diksha_table_raw_txtb_last_day":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date = (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium)"
},	
{
"diksha_table_raw_txtb_last_7_days":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium)"
},
{
"diksha_table_raw_txtb_last_30_days":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium)"
},
{
"diksha_table_raw_txtb_all":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium)"
},
{
"diksha_table_raw_crs_last_day":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date = (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium)"
},
{
"diksha_table_raw_crs_last_7_days":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays ,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium)"
},
{
"diksha_table_raw_crs_last_30_days":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays ,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium)"
},
{
"diksha_table_raw_crs_all":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays ,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium)"
},
{
"diksha_table_raw_all_last_day":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where content_view_date = (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,collection_type,object_id,content_medium)"
},
{
"diksha_table_raw_all_last_7_days":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,collection_type,content_gradelevel,object_id,content_medium)"
},
{
"diksha_table_raw_all_last_30_days":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,collection_type,content_subject,content_gradelevel,object_id,content_medium)"
},
{
"diksha_table_raw_all_last_30_days":"(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content group by district_id,district_name,content_name,collection_type,collection_name,content_subject,content_gradelevel,content_medium,object_id)"
},
{
"diksha_stack_bar_raw_last_day":"(select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select now()::DATE) group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5)"
},
{
"diksha_stack_bar_raw_last_7_days":"(select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5)"
},
{
"diksha_stack_bar_raw_last_30_days":"(select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5)"
},
{
"diksha_stack_bar_raw_all":"(select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5)"
},
{
"diksha_stack_bar_raw_all_last_day":"(select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date = (select now()::DATE) group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5)"
},
{
"diksha_stack_bar_raw_all_last_7_days":"(select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5)"
},
{
"diksha_stack_bar_raw_all_last_30_days":"(select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5)"
},
{
"diksha_stack_bar_raw_all_all":"(select district_id,district_name,initcap(user_login_type)as user_login_type,initcap(content_gradelevel)as content_gradelevel,initcap(content_subject)as content_subject,sum(total_count) as Total_content_plays from diksha_total_content where user_login_type is not null and collection_type is not null and collection_type ='TextBook' and user_login_type <> 'NA'and district_name is not null and district_id is not null group by district_id,district_name,user_login_type,content_gradelevel,content_subject order by 1,3,4,5)"
}
]


